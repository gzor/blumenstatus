name: CI

on: [push]

jobs:
  build:

    runs-on: self-hosted

    steps:
    - uses: actions/checkout@v2
    - name: Run a one-line script
      run: pio run -t upload
      id: "1"
      
    - name: cleanup old action artifacts
      run: workflow-scripts/delete-old-artifacts.sh ${{ secrets.REPO_ACCESS_TOKEN }}
      
    - name: Upload Compiled Binary as Artifact
      uses: actions/upload-artifact@v1.0.0
      with:
        name: firmware.bin 
        path: .pio/build/esp32doit-devkit-v1/
      id: "2"  
        
        
      
#    - name: Run a multi-line script
#      run: |
#        echo Add other actions to build,
#        echo test, and deploy your project.
